<!DOCTYPE html>

<html lang="en" data-content_root="./">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Subpatterns and peaks &#8212; Continuous-Peak-Fit 0.0 alpha documentation</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=8f2a1f02" />
    <link rel="stylesheet" type="text/css" href="_static/agogo.css?v=08520df9" />
    <script src="_static/documentation_options.js?v=cddd5768"></script>
    <script src="_static/doctools.js?v=9bcbadda"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Bounds" href="bounds.html" />
    <link rel="prev" title="Sytax for iterating over hdf5 files." href="input%20file%20h5%20syntax.html" /> 
  </head><body>
    <div class="header-wrapper" role="banner">
      <div class="header">
        <div class="headertitle"><a
          href="index.html">Continuous-Peak-Fit 0.0 alpha documentation</a></div>
        <div class="rel" role="navigation" aria-label="Related">
          <a href="input%20file%20h5%20syntax.html" title="Sytax for iterating over hdf5 files."
             accesskey="P">previous</a> |
          <a href="bounds.html" title="Bounds"
             accesskey="N">next</a> |
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a>
        </div>
       </div>
    </div>

    <div class="content-wrapper">
      <div class="content">
        <div class="document">
            
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="subpatterns-and-peaks">
<h1>Subpatterns and peaks<a class="headerlink" href="#subpatterns-and-peaks" title="Link to this heading">¶</a></h1>
<p>Each subpattern is defined by number of parameters contained within a python dictionary. The dictionary for each subpattern is contained with in a list called ‘fit_orders’. e.g.:</p>
<blockquote>
<div><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">fit_orders</span> <span class="o">=</span> <span class="p">[</span>
       <span class="p">{</span>
         <span class="s2">&quot;range&quot;</span><span class="p">:</span> <span class="p">[[</span><span class="mf">3.5</span><span class="p">,</span><span class="mf">3.8</span><span class="p">]],</span>
         <span class="s2">&quot;background&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span>
         <span class="s2">&quot;peak&quot;</span><span class="p">:</span> <span class="p">[{</span>
             <span class="s2">&quot;phase&quot;</span><span class="p">:</span> <span class="s2">&quot;Steel&quot;</span><span class="p">,</span>
             <span class="s2">&quot;hkl&quot;</span><span class="p">:</span> <span class="s1">&#39;111&#39;</span><span class="p">,</span>
             <span class="s2">&quot;d-space&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
             <span class="s2">&quot;height&quot;</span><span class="p">:</span> <span class="mi">12</span><span class="p">,</span>
             <span class="s2">&quot;profile&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
             <span class="c1">#&quot;profile_fixed&quot;: 1,</span>
             <span class="s2">&quot;width&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
             <span class="c1">#&quot;symmetry&quot;: 2</span>
           <span class="p">}],</span>
         <span class="p">},</span>
       <span class="p">{</span>
         <span class="s2">&quot;range&quot;</span><span class="p">:</span> <span class="p">[[</span><span class="mf">4.1</span><span class="p">,</span><span class="mf">4.4</span><span class="p">]],</span>
         <span class="s2">&quot;background&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span>
         <span class="s2">&quot;peak&quot;</span><span class="p">:</span> <span class="p">[{</span>
             <span class="s2">&quot;phase&quot;</span><span class="p">:</span> <span class="s2">&quot;Steel&quot;</span><span class="p">,</span>
             <span class="s2">&quot;hkl&quot;</span><span class="p">:</span> <span class="s1">&#39;200&#39;</span><span class="p">,</span>
             <span class="s2">&quot;d-space&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
             <span class="s2">&quot;height&quot;</span><span class="p">:</span> <span class="mi">12</span><span class="p">,</span>
             <span class="s2">&quot;profile&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
             <span class="c1">#&quot;profile_fixed&quot;: 1,</span>
             <span class="s2">&quot;width&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
             <span class="c1">#&quot;symmetry&quot;: 2</span>
           <span class="p">}],</span>
       <span class="p">},</span>
       <span class="p">]</span>
</pre></div>
</div>
</div></blockquote>
<p>With in each subpattern dictionary the following parameters are possible or needed:</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Parameter</p></th>
<th class="head"><p>Required?</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">range</span></code></p></td>
<td><p>yes</p></td>
<td><p>Defines the maximum and minimum of the range to fit with peak in. For angle dispersive diffraction data this is the maximum and minimum two theta angle (in degrees), for energy disperdive diffraction it is the maximum and minimum energy (in keV). The format is <code class="docutils literal notranslate"><span class="pre">[[min,</span> <span class="pre">max]]</span></code>.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">background</span></code></p></td>
<td><p>yes</p></td>
<td><p>This is a list of numbers that defines the background, see LINK.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">peak</span></code></p></td>
<td><p>yes</p></td>
<td><p>List of dictionaries, one for each peak. See LINK</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">imax</span></code></p></td>
<td><p>no</p></td>
<td><p>Crops the maximum intensity within the range at this value. Formatted as a single number.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">imin</span></code></p></td>
<td><p>no</p></td>
<td><p>Crops the minimum intensity within the range at this value. Formatted as a single number.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">PeakPositionSelection</span></code></p></td>
<td><p>only for multiple peaks</p></td>
<td><p>a list of [peak_n, azimuth, two theta], that makes a guess for each peak in the range.</p></td>
</tr>
</tbody>
</table>
<section id="peak-definition">
<h2>Peak definition<a class="headerlink" href="#peak-definition" title="Link to this heading">¶</a></h2>
<p>The peaks are a pesugo-Voigt peak with parameters:</p>
</section>
<section id="fixing-parameters-to-each-other">
<h2>Fixing parameters to each other<a class="headerlink" href="#fixing-parameters-to-each-other" title="Link to this heading">¶</a></h2>
<p>Parameters can be linked to previously defined paramerters, within the same range.
This is done by labelling the parameter to a previously labelled parameter.</p>
<blockquote>
<div><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="o">...</span>
<span class="p">{</span>
  <span class="s2">&quot;range&quot;</span><span class="p">:</span> <span class="p">[[</span><span class="mf">4.1</span><span class="p">,</span><span class="mf">4.4</span><span class="p">]],</span>
  <span class="s2">&quot;background&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span>
  <span class="s2">&quot;peak&quot;</span><span class="p">:</span> <span class="p">[{</span>
      <span class="s2">&quot;phase&quot;</span><span class="p">:</span> <span class="s2">&quot;Steel&quot;</span><span class="p">,</span>
      <span class="s2">&quot;hkl&quot;</span><span class="p">:</span> <span class="s1">&#39;111&#39;</span><span class="p">,</span>
      <span class="s2">&quot;d-space&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
      <span class="s2">&quot;height&quot;</span><span class="p">:</span> <span class="mi">12</span><span class="p">,</span>
      <span class="s2">&quot;profile&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
      <span class="c1">#&quot;profile_fixed&quot;: 1,</span>
      <span class="s2">&quot;width&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
      <span class="c1">#&quot;symmetry&quot;: 2</span>
    <span class="p">},{</span>
      <span class="s2">&quot;phase&quot;</span><span class="p">:</span> <span class="s2">&quot;Steel&quot;</span><span class="p">,</span>
      <span class="s2">&quot;hkl&quot;</span><span class="p">:</span> <span class="s1">&#39;200&#39;</span><span class="p">,</span>
      <span class="s2">&quot;d-space&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="o">**</span><span class="s2">&quot;order2equal0&quot;</span><span class="o">**</span><span class="p">],</span>
      <span class="s2">&quot;height&quot;</span><span class="p">:</span> <span class="mi">12</span><span class="p">,</span>
      <span class="s2">&quot;profile&quot;</span><span class="p">:</span> <span class="o">**</span><span class="s2">&quot;all&quot;</span><span class="o">**</span><span class="p">,</span>
      <span class="c1">#&quot;profile_fixed&quot;: 1,</span>
      <span class="s2">&quot;width&quot;</span><span class="p">:</span> <span class="o">**</span><span class="s2">&quot;less0&quot;</span><span class="o">**</span><span class="p">,</span>
      <span class="c1">#&quot;symmetry&quot;: 2</span>
    <span class="p">}],</span>
 <span class="o">...</span>
</pre></div>
</div>
</div></blockquote>
<p>syntax:</p>
<p>The syntax allows parameters to be fixed to the same parameter in a preceeding peak within the same range.</p>
<p><strong>is this 0 counted or 1 counted??</strong>
Either way we need to check for min/max out of range</p>
<p><strong>Syntax definition</strong></p>
<p>String that goes within list. The string is formed of two parts:</p>
<ol class="upperalpha">
<li><p>part saying which parts of the series to fix. Commands are:</p>
<blockquote>
<div><ul class="simple">
<li><p>all</p></li>
<li><p>order (ideally for Fourier series)</p></li>
<li><p>n-m, where n and m are integer values (ideally for splines)</p></li>
</ul>
</div></blockquote>
</li>
<li><p>a part defining its relation to the other parts. It is formed of a string, optionally followed by a number. Possible strings are:</p>
<blockquote>
<div><ul class="simple">
<li><p>equal</p></li>
</ul>
</div></blockquote>
</li>
</ol>
<p>Other relations (greater than, less than, times, divide) are not implemented yet.</p>
<p>If either part is missing then it is assumed to be “all” and “equal0”. Hence an empty string will make all the series values equal to those of the first peak.</p>
<p><strong>for fourier series</strong></p>
<p>“d-space”: [2, “2ndOrderEqualPeak0”] — make 2nd order terms the same betwen this peak and peak 0.</p>
<p>“d-space”: [2, “1st2ndOrderEqualPeak0”] — make 1st and 2nd order terms the same betwen this peak and peak 0.</p>
<p>“d-space”: [0,2, “2ndOrderEqualPeak0”] — no 1st order terms, make 2nd order terms the same betwen this peak and peak 0 (compatible with [0,2]).</p>
<p>“profile”: [0, “AllEqual0”] — make all terms the same as first peak.</p>
<p>“profile”: “AllEqual0” — make all terms the same as first peak. Same as [<em>n</em>, “allwith1”].
“profile”: “Fixed0.04” — fixed as single value of 0.04.
“profile”: [1, “Fixed(0.04,0.02,0)”, “AllEqual0”]</p>
<p><a href="#id1"><span class="problematic" id="id2">*</span></a>strings can be combined. *
“d-space”: [2, “1-2OrderEqualPeak0”, “0thOrderLessPeak0”] — make 1st and 2nd order terms the same betwen this peak and peak 0. make 0th order less than peak 0.</p>
<p><strong>for splines</strong></p>
<p>“height”: [12, “AllEqualPeak0”] — make all terms the same as first peak.</p>
<p>“height”: [12, “4-13EqualPeak0”] — make values 4-13 (of 25) the same as first peak.</p>
<p>“height”: [12, “4-13GreaterPeak1”] — make values 4-13 (of 25) greater than those of the second peak.</p>
<p>To fix 3 or more peaks they just have to be assembled in the correct order.</p>
</section>
</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
        </div>
        <div class="sidebar">
          
          <h3>Table of Contents</h3>
          <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="x-ray%20diffraction.html">X-ray diffraction fitting</a></li>
<li class="toctree-l1"><a class="reference internal" href="algorithm.html">Algorithm</a></li>
<li class="toctree-l1"><a class="reference internal" href="installation.html">Download and Install</a></li>
<li class="toctree-l1"><a class="reference internal" href="running%20cpf.html"><em>Continuous peak fit</em>, via the command line</a></li>
<li class="toctree-l1"><a class="reference internal" href="input%20file%20short.html">Input file structure (short)</a></li>
<li class="toctree-l1"><a class="reference internal" href="input%20file.html">Input file structure (long)</a></li>
<li class="toctree-l1"><a class="reference internal" href="input%20file%20h5%20syntax.html">Sytax for iterating over hdf5 files.</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Subpatterns and peaks</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#peak-definition">Peak definition</a></li>
<li class="toctree-l2"><a class="reference internal" href="#fixing-parameters-to-each-other">Fixing parameters to each other</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="bounds.html">Bounds</a></li>
<li class="toctree-l1"><a class="reference internal" href="output_file_structure.html">Output files:</a></li>
<li class="toctree-l1"><a class="reference internal" href="example%20function%20tests.html">XRD_FitPattern’s examples and the features they test.</a></li>
<li class="toctree-l1"><a class="reference internal" href="whatsnew.html">Release Notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="api.html">APIs</a></li>
</ul>

          <search role="search">
            <h3 style="margin-top: 1.5em;">Search</h3>
            <form class="search" action="search.html" method="get">
                <input type="text" name="q" />
                <input type="submit" value="Go" />
            </form>
          </search>

        </div>
        <div class="clearer"></div>
      </div>
    </div>

    <div class="footer-wrapper">
      <div class="footer">
        <div class="left">
          <div role="navigation" aria-label="Related">
            <a href="input%20file%20h5%20syntax.html" title="Sytax for iterating over hdf5 files."
              >previous</a> |
            <a href="bounds.html" title="Bounds"
              >next</a> |
            <a href="py-modindex.html" title="Python Module Index"
              >modules</a> |
            <a href="genindex.html" title="General Index"
              >index</a>
          </div>
          <div role="note" aria-label="source link">
              <br/>
              <a href="_sources/subpattern structure.rst.txt"
                rel="nofollow">Show Source</a>
          </div>
        </div>

        <div class="right">
          
    <div class="footer" role="contentinfo">
    &#169; Copyright Simon Hunt &amp; Danielle Fenech, 2020.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 8.1.3.
    </div>
        </div>
        <div class="clearer"></div>
      </div>
    </div>

  </body>
</html>